<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Powered by Linear Algebra - 12&nbsp; Singular Value Decomposition</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch6d.html" rel="next">
<link href="./Ch6b.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch6c.html"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Singular Value Decomposition</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Powered by Linear Algebra</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">index.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Matrices and Vectors</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Matrix Inverse</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Covariance Matrices, MV Normal Distribution, Delta Method</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Linear Statistical Models</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Matrix Rank</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Vector Spaces</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inner Product Spaces</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5c.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Shrinkage Estimators</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Eigenanalysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6b.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Principal Components</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6c.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Singular Value Decomposition</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch6d.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Pseudoinverse and Double Descent</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch7a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Recommender Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch8a.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Neural Networks</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#basic-idea" id="toc-basic-idea" class="nav-link active" data-scroll-target="#basic-idea"><span class="header-section-number">12.1</span> Basic Idea</a></li>
  <li><a href="#solution" id="toc-solution" class="nav-link" data-scroll-target="#solution"><span class="header-section-number">12.2</span> Solution</a></li>
  <li><a href="#checking-the-formula" id="toc-checking-the-formula" class="nav-link" data-scroll-target="#checking-the-formula"><span class="header-section-number">12.3</span> Checking the Formula</a></li>
  <li><a href="#uniqueness" id="toc-uniqueness" class="nav-link" data-scroll-target="#uniqueness"><span class="header-section-number">12.4</span> Uniqueness</a></li>
  <li><a href="#the-fundamental-theorem-of-linear-algebra" id="toc-the-fundamental-theorem-of-linear-algebra" class="nav-link" data-scroll-target="#the-fundamental-theorem-of-linear-algebra"><span class="header-section-number">12.5</span> The Fundamental Theorem of Linear Algebra</a></li>
  <li><a href="#the-data-scientists-swiss-army-knife" id="toc-the-data-scientists-swiss-army-knife" class="nav-link" data-scroll-target="#the-data-scientists-swiss-army-knife"><span class="header-section-number">12.6</span> The Data Scientist’s Swiss Army Knife</a>
  <ul class="collapse">
  <li><a href="#rank-of-a" id="toc-rank-of-a" class="nav-link" data-scroll-target="#rank-of-a"><span class="header-section-number">12.6.1</span> Rank of <span class="math inline">\(A\)</span></a></li>
  <li><a href="#svd-as-matrix-pseudoinverse" id="toc-svd-as-matrix-pseudoinverse" class="nav-link" data-scroll-target="#svd-as-matrix-pseudoinverse"><span class="header-section-number">12.6.2</span> SVD as matrix pseudoinverse</a></li>
  <li><a href="#svd-in-linear-models" id="toc-svd-in-linear-models" class="nav-link" data-scroll-target="#svd-in-linear-models"><span class="header-section-number">12.6.3</span> SVD in linear models</a></li>
  </ul></li>
  <li><a href="#example-census-data" id="toc-example-census-data" class="nav-link" data-scroll-target="#example-census-data"><span class="header-section-number">12.7</span> Example: Census Data</a></li>
  <li><a href="#application-svd-as-the-best-low-rank-approximation" id="toc-application-svd-as-the-best-low-rank-approximation" class="nav-link" data-scroll-target="#application-svd-as-the-best-low-rank-approximation"><span class="header-section-number">12.8</span> Application: SVD as the Best Low-Rank Approximation</a></li>
  <li><a href="#your-turn" id="toc-your-turn" class="nav-link" data-scroll-target="#your-turn"><span class="header-section-number">12.9</span> Your Turn</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Singular Value Decomposition</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div style="page-break-after: always;"></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Goals of this chapter:
</div>
</div>
<div class="callout-body-container callout-body">
<p>We’ve seen the notion of eigenanalysis for square matrices. Well, it turns out this can be extended usefully for nonsquare matrices, via <em>Singular Value Decomposition</em> (SVD), the topic of this chapter.</p>
</div>
</div>
<section id="basic-idea" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="basic-idea"><span class="header-section-number">12.1</span> Basic Idea</h2>
<p>Here is what we are aiming for.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Our target relation:
</div>
</div>
<div class="callout-body-container callout-body">
<p>Given an <span class="math inline">\(m \times n\)</span> matrix <span class="math inline">\(A\)</span>, we wish to find orthogonal matrices <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span>, and a matrix <span class="math inline">\(\Sigma = diag(\sigma_1,...,\sigma_n)\)</span> whose nonzero elements are positive, such that</p>
<p><span id="eq-svd"><span class="math display">\[
A = U \Sigma V'
\tag{12.1}\]</span></span></p>
<p>By convention the ordering of columns is set so that the <span class="math inline">\(\sigma_i\)</span> occur in nonincreasing order.</p>
<p>Note that, by matrix partitioning, <a href="#eq-svd">Equation&nbsp;<span>12.1</span></a> also says that</p>
<p><span id="eq-aissumuivi"><span class="math display">\[
A = \sum_{i=1}^n \sigma_i u_i v_i'
\tag{12.2}\]</span></span></p>
</div>
</div>
<p>Note the dimensions:</p>
<ul>
<li><p><span class="math inline">\(U\)</span> is <span class="math inline">\(m \times n\)</span></p></li>
<li><p><span class="math inline">\(V\)</span> is <span class="math inline">\(n \times n\)</span></p></li>
<li><p><span class="math inline">\(\Sigma\)</span> is <span class="math inline">\(n \times n\)</span></p></li>
</ul>
<p>Let <span class="math inline">\(r\)</span> denote the rank of <span class="math inline">\(A\)</span>. Recall that <span class="math inline">\(r \leq \min(m,n)\)</span>. It will turn out that <span class="math inline">\(\sigma_i = 0\)</span> for <span class="math inline">\(i=r+1,...,n\)</span>.</p>
</section>
<section id="solution" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="solution"><span class="header-section-number">12.2</span> Solution</h2>
<p>There are various derivations, e.g.&nbsp;along the lines of <a href="Ch6a.html#sec-firstPC"><span>Section&nbsp;10.2.1</span></a> (one maximizes the quantity <span class="math inline">\(U A V'\)</span>), but let’s go quickly to the answer:</p>
<ol type="1">
<li><p>Compute the eigenvalues <span class="math inline">\(\sigma_1,...,\sigma_n\)</span> and eigenvectors <span class="math inline">\(q_1,...,q_n\)</span> of <span class="math inline">\(A'A\)</span>.</p></li>
<li><p>Since <span class="math inline">\(A'A\)</span> is symmetric and positive-semidefinite, its eigenvalues will be nonnegative and its length-1 eigenvectors will be orthogonal.</p></li>
<li><p>Set <span class="math inline">\(\Sigma\)</span> to <span class="math inline">\(diag(\sqrt{\sigma_1},...,\sqrt{\sigma_n})\)</span>, the nonincreasing list of eigenvalues. Set the columns of <span class="math inline">\(V\)</span> to the corresponding eigenvectors (recall <span class="quarto-unresolved-ref">?sec-diagonalizable</span>).</p></li>
<li><p>Set</p></li>
</ol>
<p><span class="math display">\[
u_i = \frac{1}{\sigma_i} Av_i, ~ i=1,...,r
\]</span></p>
<p>Using the Gram-Schmidt Method (<a href="Ch5b.html#sec-gramschmidt"><span>Section&nbsp;8.10</span></a>), we can compute (if <span class="math inline">\(r &lt; m\)</span> necessitates it) vectors <span class="math inline">\(u_{r+1},...u_m\)</span> so that <span class="math inline">\(u_1,...,u_m\)</span> is an orthonormal basis for <span class="math inline">\(\mathcal{R}^m\)</span>. Set <span class="math inline">\(U\)</span>, decribed in partitioning terms: to</p>
<p><span class="math display">\[
U = (u_1|...|u_m)
\]</span></p>
</section>
<section id="checking-the-formula" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="checking-the-formula"><span class="header-section-number">12.3</span> Checking the Formula</h2>
<p>Are <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span> really orthogonal, and does <span class="math inline">\(U \Sigma V'\)</span> really work out to be <span class="math inline">\(A\)</span>?</p>
<ul>
<li><p><span class="math inline">\(U\)</span> is orthogonal.</p>
<p>This follows immediately from the fact that the columns of <span class="math inline">\(U\)</span> are an orthonormal basis from <span class="math inline">\(\mathcal{R}^m\)</span>.</p></li>
<li><p><span class="math inline">\(V\)</span> is orthogonal, by <span class="quarto-unresolved-ref">?sec-eigortho</span>.</p></li>
<li><p>The product evaluates to <span class="math inline">\(A\)</span>, as claimed.</p>
<p>Using matrix partitioning, we have</p>
<p><span class="math display">\[
  U \Sigma = (\sigma_1 u_1 | ... | \sigma_n u_n)
  \]</span></p>
<p>So, again using partitioning,</p>
<p><span class="math display">\[
  U \Sigma V' = (\sigma_1 u_1 | ... | \sigma_n u_n)
   \left (
   \begin{array}{r}
   v_1' \\
   ... \\
   v_n'  \\
   \end{array}
   \right )
  = \sum_{i=1}^n \sigma_i u_i v_i'  
  \]</span></p>
<p>That last expression is equal to <span class="math inline">\(A\)</span>, by <a href="#eq-aissumuivi">Equation&nbsp;<span>12.2</span></a>.</p></li>
</ul>
</section>
<section id="uniqueness" class="level2" data-number="12.4">
<h2 data-number="12.4" class="anchored" data-anchor-id="uniqueness"><span class="header-section-number">12.4</span> Uniqueness</h2>
<p>The SVD can be shown to be unique, if there are no repeated eigenvalues. If the latter exist, one can permute the corresponding columns of <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span>, but otherwise uniqueness holds.</p>
</section>
<section id="the-fundamental-theorem-of-linear-algebra" class="level2" data-number="12.5">
<h2 data-number="12.5" class="anchored" data-anchor-id="the-fundamental-theorem-of-linear-algebra"><span class="header-section-number">12.5</span> The Fundamental Theorem of Linear Algebra</h2>
<p>One can define four fundamental subspaces for any matrix <span class="math inline">\(A\)</span>. We will need the following:</p>
<ul>
<li><p><span class="math inline">\(\textrm{row space}(A), \mathcal{R}(A)\)</span>: <span class="math inline">\(\{x'A\}~~\)</span> (all linear combinations of rows of <span class="math inline">\(A\)</span>)</p></li>
<li><p><span class="math inline">\(\textrm{column space}(A), \mathcal{C}(A)\)</span>: <span class="math inline">\(\{Ax\}~~\)</span> (all linear combinations of columns of <span class="math inline">\(A\)</span>)</p></li>
<li><p><span class="math inline">\(\textrm{null space}(A), \mathcal{N}(A)\)</span>: <span class="math inline">\(\{x: Ax = 0\}\)</span></p></li>
<li><p><span class="math inline">\(\textrm{left null space}(A) = \mathcal{N}(A')\)</span>: <span class="math inline">\(\{x: x'A = 0\}\)</span></p></li>
</ul>
<p>These subspaces have various properties, which may be verified via SVD. <a href="#eq-aissumuivi">Equation&nbsp;<span>12.2</span></a> will come in very handy.</p>
<p>Consider the column space first. From <a href="#eq-aissumuivi">Equation&nbsp;<span>12.2</span></a> write</p>
<p><span id="eq-Ax"><span class="math display">\[
Ax = \sum_{i=1}^n \sigma_i u_i v_i' x
\tag{12.3}\]</span></span></p>
<p>Note that <span class="math inline">\(v_i'x\)</span> is a scalar, so we have</p>
<p><span id="eq-Ax1"><span class="math display">\[
\begin{aligned}
Ax &amp;= \sum_{i=1}^n [\sigma_i (v_i' x)] u_i \\
&amp;= \sum_{i=1}^r [\sigma_i (v_i' x)] u_i
\end{aligned}
\tag{12.4}\]</span></span></p>
<p>So</p>
<p><span id="eq-colsubset"><span class="math display">\[
\mathcal{C}(A) \subset \textrm{ span}(u_1,...,u_r)
\tag{12.5}\]</span></span></p>
<p>Now, is the left side equal to all of the right side? Say a member of the right side is <span class="math inline">\(c_1 u_1+...+c_r u_r\)</span>. Then, using the fact that <span class="math inline">\(\{v_1....,v_r\}\)</span> is an orthonormal set, take <span class="math inline">\(x\)</span> to be</p>
<p><span class="math display">\[
x = \sum_{j=1}^r \frac{c_j}{\sigma_j} v_j
\]</span></p>
<p>Then for each <span class="math inline">\(i\)</span>, we have</p>
<p><span class="math display">\[
\sigma_i v_i'x =c_i
\]</span></p>
<p>and</p>
<p><span class="math display">\[
Ax = \sum_{i=1}^r c_i u_i
\]</span></p>
<p>as desired, so <a href="#eq-colsubset">Equation&nbsp;<span>12.5</span></a> is actually an equality.</p>
<p>We have thus characterized one of the four fundamental subspaces:</p>
<blockquote class="blockquote">
<p><span class="math inline">\(\mathcal{C}(A)\)</span> has dimension <span class="math inline">\(r\)</span>, with basis <span class="math inline">\(u_1,...,u_r\)</span>.</p>
</blockquote>
<p>Now look at the null space. <span class="math inline">\(Ax = 0\)</span> means that the vector <span class="math inline">\(x\)</span> is orthogonal to each row of <span class="math inline">\(A\)</span>. Thus</p>
<p><span class="math display">\[
\begin{aligned}
\mathcal{N}(A) &amp;= \mathcal{R}(A)^{\perp} \\
&amp;= \mathcal{C}(A')^{\perp}
\end{aligned}
\]</span></p>
<p>We already found above a characterization of the column space of a matrix, which we now apply to <span class="math inline">\(A'\)</span>: <span class="math inline">\(\mathcal{C}(A')\)</span> has dimension <span class="math inline">\(r\)</span>, with basis <span class="math inline">\(v_1,...,v_r\)</span>. Applying <span class="math inline">\(\perp\)</span>, and noting that orthogonality of <span class="math inline">\(v_1,...,v_n\)</span>, we can now characterize a second, and even a third, of the four subspaces:</p>
<blockquote class="blockquote">
<p><span class="math inline">\(\mathcal{N}(A)\)</span> is of dimension <span class="math inline">\(n-r\)</span>, with basis <span class="math inline">\(v_{r+1},...,v_n\)</span>.</p>
<p><span class="math inline">\(\mathcal{R}(A)\)</span> is of dimension <span class="math inline">\(r\)</span>, with basis <span class="math inline">\(v_1,...,v_r\)</span>.</p>
</blockquote>
<p>We leave the fourth subspace as a Your Turn problem.</p>
</section>
<section id="the-data-scientists-swiss-army-knife" class="level2 page-columns page-full" data-number="12.6">
<h2 data-number="12.6" class="anchored" data-anchor-id="the-data-scientists-swiss-army-knife"><span class="header-section-number">12.6</span> The Data Scientist’s Swiss Army Knife</h2>
<p>There are a great many pieces of information and sources of tools packed into this innocuous-looking factorization. Let’s take a look at some:</p>
<section id="rank-of-a" class="level3" data-number="12.6.1">
<h3 data-number="12.6.1" class="anchored" data-anchor-id="rank-of-a"><span class="header-section-number">12.6.1</span> Rank of <span class="math inline">\(A\)</span></h3>
<p>This is the number of nonzero values in <span class="math inline">\(\Sigma\)</span>. This follows from <a href="Ch4.html#thm-ranknotchange">Theorem&nbsp;<span>6.1</span></a>, since <span class="math inline">\(U\)</span> and <span class="math inline">\(V\)</span>, as orthogonal matrices, are invertible.</p>
<p>It should be noted, though, that if there are some really tiny elements there, one might also entertain the thought that the true rank is less than this size, as these tiny values may be due to roundoff error from 0.</p>
</section>
<section id="svd-as-matrix-pseudoinverse" class="level3" data-number="12.6.2">
<h3 data-number="12.6.2" class="anchored" data-anchor-id="svd-as-matrix-pseudoinverse"><span class="header-section-number">12.6.2</span> SVD as matrix pseudoinverse</h3>
<p>Recall the example in <a href="Ch4.html#sec-censusrref"><span>Section&nbsp;6.1</span></a>. We could not have dummy-variable columns for both male and female, as their sum would be a column of all 1s, in addition to a column the X data matrix already had. The three columns would then have a nonzero linear combination that evaluates to the 0 vector. Then in <a href="Ch3.html#eq-linregformula">Equation&nbsp;<span>5.4</span></a>, <span class="math inline">\(A\)</span> (i.e.&nbsp;X) would not be of full rank, and <span class="math inline">\((A'A)^{-1}\)</span> would not exist.</p>
<p>And yet the equation from which that comes,</p>
<p><span id="eq-overdetermined"><span class="math display">\[
A'A b = A'S
\tag{12.6}\]</span></span></p>
<p>is still valid. We could, as in that example, remove one of the gender columns, thus solving the problem of less than full rank, but the use of <em>pseudoinverses</em> (also known as <em>generalized inverses</em>) solves the problem directly. If <span class="math inline">\(A\)</span> has hundreds or thousands of columns, say, the use of pseudoinverses may be more convenient.</p>
<p>We omit the formal definition of pseudoinverses and their properties. We will note the use of the latter as the need arises. For now, we state without proof that:</p>
<ul>
<li><p>One of the most famous forms of pseudoinverse, Moore-Penrose, is based on SVD. Given the SVD of a matrix <span class="math inline">\(M\)</span>,</p>
<p><span class="math display">\[
M = U_M \Sigma_M V_{M}'
\]</span></p>
<p>its Moore-Penrose inverse, denoted by <span class="math inline">\(M^{-1}\)</span> is</p>
<p><span class="math display">\[
M^{-} = V_M \Sigma_M^{-} U_{M}'
\]</span></p>
<p>where <span class="math inline">\(\Sigma_M^{-}\)</span> is the diagonal matrix obtained form <span class="math inline">\(\Sigma_M\)</span> by replacing each nonzero element by its reciprocal.</p></li>
<li><p>The Moore-Penrose solution of <span class="math inline">\(Mz = w\)</span> for vectors <span class="math inline">\(z\)</span> and <span class="math inline">\(w\)</span>, is <span class="math inline">\(M^{-} w\)</span>.</p></li>
</ul>
<p>By the way, the R function <strong>MASS::ginv</strong> performs the necessary computation for us; we need not call <strong>svd()</strong>.</p>
</section>
<section id="svd-in-linear-models" class="level3 page-columns page-full" data-number="12.6.3">
<h3 data-number="12.6.3" class="anchored" data-anchor-id="svd-in-linear-models"><span class="header-section-number">12.6.3</span> SVD in linear models</h3>
<p>Now apply this to our linear model problem <a href="Ch6d.html#eq-overdetermined">Equation&nbsp;<span>13.1</span></a>. The claim is that</p>
<p><span class="math display">\[
b = A^{-} S = V \Sigma^{-} U' S
\]</span></p>
<div class="page-columns page-full"><p>solves the equation.  Let’s check (warning: this will be messy):</p><div class="no-row-height column-margin column-container"><span class="">As in <a href="Ch2.html#sec-matalg"><span>Section&nbsp;3.2</span></a>, where we found that the inverse of a product is the reverse product of the inverses, the same holds for pseudoinverses.</span></div></div>
<p><span class="math display">\[
\begin{aligned}
A'A b &amp;= (U \Sigma V')' (U \Sigma V') (U \Sigma V')^{-} S \\
&amp;= (V \Sigma U') (U \Sigma V') (V \Sigma^{-} U') S \\
&amp;= V \Sigma^2 V'V \Sigma^{-} U' S \\
&amp;= V \Sigma^{-} U' S
\end{aligned}
\]</span></p>
<p>But that is exactly the expression we found for <span class="math inline">\(A^{-1}S\)</span> above.</p>
<p><span class="math inline">\(\square\)</span></p>
</section>
</section>
<section id="example-census-data" class="level2" data-number="12.7">
<h2 data-number="12.7" class="anchored" data-anchor-id="example-census-data"><span class="header-section-number">12.7</span> Example: Census Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(qeML)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(svcensus)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># have only 1 categorical/dichotomous variable, for simple example</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(svcensus)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       age     educ occ wageinc wkswrkd gender
1 50.30082 zzzOther 102   75000      52 female
2 41.10139 zzzOther 101   12300      20   male
3 24.67374 zzzOther 102   15400      52 female
4 50.19951 zzzOther 100       0      52   male
5 51.18112 zzzOther 100     160       1 female
6 57.70413 zzzOther 100       0       0   male</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>svc <span class="ot">&lt;-</span> svcensus[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>svc <span class="ot">&lt;-</span> <span class="fu">factorsToDummies</span>(svc)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(svc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          age wageinc wkswrkd gender.female gender.male
[1,] 50.30082   75000      52             1           0
[2,] 41.10139   12300      20             0           1
[3,] 24.67374   15400      52             1           0
[4,] 50.19951       0      52             0           1
[5,] 51.18112     160       1             1           0
[6,] 57.70413       0       0             0           1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="dv">1</span>,svc[,<span class="sc">-</span><span class="dv">2</span>])</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(x)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            age wkswrkd gender.female gender.male
[1,] 1 50.30082      52             1           0
[2,] 1 41.10139      20             0           1
[3,] 1 24.67374      52             1           0
[4,] 1 50.19951      52             0           1
[5,] 1 51.18112       1             1           0
[6,] 1 57.70413       0             0           1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>xminus <span class="ot">&lt;-</span> MASS<span class="sc">::</span><span class="fu">ginv</span>(x)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>bhat <span class="ot">&lt;-</span> xminus <span class="sc">%*%</span> svc[,<span class="dv">2</span>]</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>bhat</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>           [,1]
[1,] -16022.454
[2,]    496.747
[3,]   1372.756
[4,] -13361.634
[5,]  -2660.821</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(wageinc <span class="sc">~</span> .,svcensus[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>)])<span class="sc">$</span>coef</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)         age     wkswrkd  gendermale 
 -29384.088     496.747    1372.756   10700.813 </code></pre>
</div>
</div>
<p>The two approaches are consistent with each other (though internally they are solving slightly different problems). Note that</p>
<p><span class="math display">\[
-13361.634-(-2660.821) = -10700.81
\]</span></p>
</section>
<section id="application-svd-as-the-best-low-rank-approximation" class="level2" data-number="12.8">
<h2 data-number="12.8" class="anchored" data-anchor-id="application-svd-as-the-best-low-rank-approximation"><span class="header-section-number">12.8</span> Application: SVD as the Best Low-Rank Approximation</h2>
</section>
<section id="your-turn" class="level2" data-number="12.9">
<h2 data-number="12.9" class="anchored" data-anchor-id="your-turn"><span class="header-section-number">12.9</span> Your Turn</h2>
<p>❄️ <strong>Your Turn:</strong> Show that in the SVD factorization, <span class="math inline">\(U\)</span> consists of the eigenvectors of <span class="math inline">\(AA'\)</span>.</p>
<p>❄️ <strong>Your Turn:</strong> Find a characterization of the left null space of a matrix.</p>
<p>❄️ <strong>Your Turn:</strong> Write an R function with a matrix as its sole argument, with return value consisting of an R list containing four matrices, representing the four fundamental subspaces of the input argument. Each matrix will consist of columns equal to a basis for the given subspace.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Ch6b.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Principal Components</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch6d.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Pseudoinverse and Double Descent</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>
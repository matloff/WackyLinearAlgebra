<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Linear Algebra in Data Science - 2&nbsp; Matrix Inverse</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch3.html" rel="next">
<link href="./Ch1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Ch2.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Matrix Inverse</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Linear Algebra <em>in</em> Data Science</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Matrix Multiplication</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Matrix Inverse</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Statistical Models</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#example" id="toc-example" class="nav-link active" data-scroll-target="#example"><span class="header-section-number">2.1</span> Example</a></li>
  <li><a href="#matrix-algebra" id="toc-matrix-algebra" class="nav-link" data-scroll-target="#matrix-algebra"><span class="header-section-number">2.2</span> Matrix Algebra</a></li>
  <li><a href="#computation-of-the-matrix-inverse" id="toc-computation-of-the-matrix-inverse" class="nav-link" data-scroll-target="#computation-of-the-matrix-inverse"><span class="header-section-number">2.3</span> Computation of the Matrix Inverse</a>
  <ul class="collapse">
  <li><a href="#pencil-and-paper-computation" id="toc-pencil-and-paper-computation" class="nav-link" data-scroll-target="#pencil-and-paper-computation"><span class="header-section-number">2.3.1</span> Pencil-and-paper computation</a></li>
  <li><a href="#use-of-elementary-matrices" id="toc-use-of-elementary-matrices" class="nav-link" data-scroll-target="#use-of-elementary-matrices"><span class="header-section-number">2.3.2</span> Use of elementary matrices</a></li>
  </ul></li>
  <li><a href="#nonexistent-inverse" id="toc-nonexistent-inverse" class="nav-link" data-scroll-target="#nonexistent-inverse"><span class="header-section-number">2.4</span> Nonexistent inverse</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Matrix Inverse</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div style="page-break-after: always;"></div>
<p>This is a fundamental operation in linear algebra (though ironically, related quantities are often used instead).</p>
<section id="example" class="level2 page-columns page-full" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="example"><span class="header-section-number">2.1</span> Example</h2>
<p>At the end of the last chapter, we found that for a Markov chain with transition matrix P and stationary distribution <span class="math inline">\(\nu\)</span>,</p>
<p><span class="math display">\[
\nu = P' \nu
\]</span></p>
<div class="page-columns page-full"><p>This suggests a method for computing <span class="math inline">\(\nu\)</span>, by solving the above equation.</p><div class="no-row-height column-margin column-container"><span class=""></span></div></div>
<div class="page-columns page-full"><p>Rewrite it using the identity matrix:</p><div class="no-row-height column-margin column-container"><span class="">Recall that for any square matrix C and identity matrix I of the same size, <span class="math inline">\(IC = CI = C\)</span>.</span></div></div>
<p><span class="math display">\[
(I - P') \nu = 0
\]</span></p>
<div class="page-columns page-full"><p>For the random walk chain in Chapter 1, we had</p><div class="no-row-height column-margin column-container"><span class="">In that particular model, P’ = P, but for most chains this is not the case.</span></div></div>
<p><span class="math display">\[
P =
\left (
\begin{array}{rrrrr}
0.5 &amp; 0.5 &amp; 0 &amp; 0 &amp; 0\\
0.5 &amp; 0 &amp; 0.5 &amp; 0 &amp; 0\\
0 &amp; 0.5 &amp; 0 &amp; 0.5 &amp; 0\\
0 &amp; 0 &amp; 0.5 &amp; 0 &amp; 0.5\\
0 &amp; 0 &amp; 0 &amp; 0.5 &amp; 0.5 \\
\end{array}
\right )
\]</span></p>
<p>With <span class="math inline">\(\nu = (\nu_1,\nu_2,\nu_3,\nu_4,\nu_5)'\)</span>, the equation to be solved, <span class="math inline">\((I-P') \nu = \nu\)</span>, is</p>
<p><span class="math display">\[
\left (
\begin{array}{rrrrr}
0.5 &amp; -0.5 &amp; 0 &amp; 0 &amp; 0 \\
-0.5 &amp; 1 &amp; -0.5 &amp; 0 &amp; 0 \\
0 &amp; -0.5 &amp; 1 &amp; -0.5 &amp; 0 \\
0 &amp; 0 &amp; -0.5 &amp; 1 &amp; -0.5 \\
0 &amp; 0 &amp; 0 &amp; -0.5 &amp; 0.5 \\
\end{array}
\right )
\left (
\begin{array}{rrrrr}
\nu_1 \\
\nu_2 \\
\nu_3 \\
\nu_4 \\
\nu_5 \\
\end{array}
\right ) =
\left (
\begin{array}{rrrrr}
0 \\
0 \\
0 \\
0 \\
0 \\
\end{array}
\right )
\]</span></p>
<p>If we perform the matrix multiplication, we have an ordinary system of linear equations:</p>
<p><span class="math display">\[
\begin{array}{rrrrr}
0.5 \nu_1 - 0.5 \nu_2 = 0 \\
-0.5 \nu_1 + \nu_2 - 0.5 \nu_3 = 0 \\
-0.5 \nu_2 + \nu_3 - 0.5 \nu_4 = 0 \\
-0.5 \nu_3 + \nu_4 - 0.5 \nu_5 = 0 \\
-0.5 \nu_4 + 0.5 \nu_5 = 0 \\
\end{array}
\]</span></p>
<p>This is high school math, and we could solve the equations that way. But this is literaally what linear algebra was invented for, solving systems of equations! We will use matrix inverse.</p>
<p>But first, we have a problem to solve: The only solution to the above system is with all <span class="math inline">\(\nu_i = 0\)</span>. We need an equation involving a nonzero quantity.</p>
<p>But we do have such an equation. The <span class="math inline">\(\nu\)</span> is a stationary distribution for a Markov chain, and thus must sum to 1.0. Let’s replace the last row by that relation:</p>
<p><span class="math display">\[
\left (
\begin{array}{rrrrr}
0.5 &amp; -0.5 &amp; 0 &amp; 0 &amp; 0 \\
-0.5 &amp; 1 &amp; -0.5 &amp; 0 &amp; 0 \\
0 &amp; -0.5 &amp; 1 &amp; -0.5 &amp; 0 \\
0 &amp; 0 &amp; -0.5 &amp; 1 &amp; -0.5 \\
1 &amp; 1 &amp; 1 &amp; 1 &amp; 1 \\
\end{array}
\right )
\left (
\begin{array}{rrrrr}
\nu_1 \\
\nu_2 \\
\nu_3 \\
\nu_4 \\
\nu_5 \\
\end{array}
\right ) =
\left (
\begin{array}{rrrrr}
0 \\
0 \\
0 \\
0 \\
1 \\
\end{array}
\right )
\]</span></p>
<p>More compactly,</p>
<p><span class="math display">\[
B \nu = d
\]</span></p>
<p>Many square matrices <span class="math inline">\(A\)</span> have a multiplicative inverse, denoted by <span class="math inline">\(A^{-1}\)</span>, with the property that</p>
<p><span class="math display">\[
A^{-1} A = A A^{-1} = I
\]</span></p>
<p>If our matrix <span class="math inline">\(B\)</span> is invertible, we can premultiply both sides of our equation above, yielding</p>
<p><span class="math display">\[
B^{-1} d = B^{-1} B \nu = \nu
\]</span></p>
<p>So, we have obtained our solution for the stationary distribution. We can evaluate it numerically via the R <strong>solve</strong> function, which finds matrix inverse:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rbind</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="fu">c</span>(<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>,<span class="dv">0</span>), <span class="fu">c</span>(<span class="dv">0</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">0</span>),</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="fl">0.5</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="fl">0.5</span>), <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>B</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3] [,4] [,5]
[1,]  0.5 -0.5  0.0  0.0  0.0
[2,] -0.5  1.0 -0.5  0.0  0.0
[3,]  0.0 -0.5  1.0 -0.5  0.0
[4,]  0.0  0.0 -0.5  1.0 -0.5
[5,]  1.0  1.0  1.0  1.0  1.0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>Binv <span class="ot">&lt;-</span> <span class="fu">solve</span>(B)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># check the inverse</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Binv <span class="sc">%*%</span> B  <span class="co"># yes, get I (of course with some roundoff error)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              [,1]         [,2]          [,3]          [,4]          [,5]
[1,]  1.000000e+00 1.942890e-16 -1.387779e-16  1.942890e-16  8.326673e-17
[2,]  1.942890e-16 1.000000e+00  3.053113e-16 -2.775558e-17  8.326673e-17
[3,] -2.775558e-17 0.000000e+00  1.000000e+00  0.000000e+00  2.775558e-17
[4,] -1.665335e-16 4.996004e-16 -3.608225e-16  1.000000e+00 -2.775558e-17
[5,] -1.665335e-16 7.216450e-16 -4.996004e-16  5.551115e-17  1.000000e+00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>nu <span class="ot">&lt;-</span> Binv <span class="sc">%*%</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>nu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1]
[1,]  0.2
[2,]  0.2
[3,]  0.2
[4,]  0.2
[5,]  0.2</code></pre>
</div>
</div>
<p>This confirms our earlier speculation based on powers of <span class="math inline">\(P'\)</span>.</p>
</section>
<section id="matrix-algebra" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="matrix-algebra"><span class="header-section-number">2.2</span> Matrix Algebra</h2>
<p>If the inverses of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> exist, and <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are conformable, then <span class="math inline">\((AB)^{-1}\)</span> exists and is equal to <span class="math inline">\(B^{-1} A^{-1}\)</span>.</p>
<p>Also, <span class="math inline">\((A')^{-1}\)</span> exists and is equal to <span class="math inline">\((A^{-1})'\)</span>.</p>
<p>❄️ <strong>Your Turn:</strong> Prove these assertions.</p>
</section>
<section id="computation-of-the-matrix-inverse" class="level2 page-columns page-full" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="computation-of-the-matrix-inverse"><span class="header-section-number">2.3</span> Computation of the Matrix Inverse</h2>
<p>Finding the inverse of a large matrix – in data science applications, the number of rows and columns <span class="math inline">\(n\)</span> can easily be hundreds or more – can be computationally challenging. The run time is proportional to <span class="math inline">\(n^3\)</span>, and roundoff error can be an issue. Sophisticated algorithms have been developed, such as QR and Choleski decompositions. So in R, we should use, say, <strong>qr.solve</strong> rather than <strong>solve</strong> if we are working with sizable matrices.</p>
<p>The classic “pencil and paper” method for matrix inversion is instructive, and will be presented here.</p>
<section id="pencil-and-paper-computation" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="pencil-and-paper-computation"><span class="header-section-number">2.3.1</span> Pencil-and-paper computation</h3>
<p>The basic idea follows the pattern the reader learned for solving systems of linear equations, but with the added twist of involving some matrix multiplication.</p>
<p>Let’s take as our example</p>
<p><span class="math display">\[
A =
\left (
\begin{array}{rr}
4 &amp; 7 \\
-8 &amp; 15  \\
\end{array}
\right )
\]</span></p>
<p>We aim to transform this to the 2x2 identity matrix, via a sequence of row operations.</p>
</section>
<section id="use-of-elementary-matrices" class="level3 page-columns page-full" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="use-of-elementary-matrices"><span class="header-section-number">2.3.2</span> Use of elementary matrices</h3>
<p>Let’s multiply row 1 by 1/4, to put 1 in the first element:</p>
<p><span class="math display">\[
\left (
\begin{array}{rr}
1 &amp; \frac{7}{4} \\
-8 &amp; 15  \\
\end{array}
\right )
\]</span></p>
<p>In matrix terms, that operation is equivalent to premultiplying <span class="math inline">\(A\)</span> by</p>
<p><span class="math display">\[
E_1=
\left (
\begin{array}{rr}
\frac{1}{4} &amp; 0  \\
0 &amp; 1  \\
\end{array}
\right )
\]</span></p>
<p>We then add 8 times row 1 to row 2, yielding</p>
<p><span class="math display">\[
\left (
\begin{array}{rr}
1 &amp; \frac{7}{4} \\
0 &amp; 29  \\
\end{array}
\right )
\]</span></p>
<p>The premultiplier for this operation is</p>
<p><span class="math display">\[
E_2=
\left (
\begin{array}{rr}
1 &amp; 0  \\
8 &amp; 1  \\
\end{array}
\right )
\]</span></p>
<p>Multiply row 2 by 1/29:</p>
<p><span class="math display">\[
\left (
\begin{array}{rr}
1 &amp; \frac{7}{4} \\
0 &amp; 1  \\
\end{array}
\right )
\]</span></p>
<p>corresponding to</p>
<p><span class="math display">\[
E_3=
\left (
\begin{array}{rr}
1 &amp; 0  \\
8 &amp; 1/29  \\
\end{array}
\right )
\]</span></p>
<p>And finally, add -7/4 row 2 to row 1.</p>
<p><span class="math display">\[
\left (
\begin{array}{rr}
1 &amp; 0 \\
0 &amp; 1  \\
\end{array}
\right )
\]</span></p>
<p>The premultiplier is</p>
<p><span class="math display">\[
E_4 =
\left (
\begin{array}{rr}
1 &amp; \frac{7}{4} \\
0 &amp; 1  \\
\end{array}
\right )
\]</span></p>
<p>Now, how does that give use <span class="math inline">\(A^{-1}\)</span>? The method your were taught probably set up the partioned matrix <span class="math inline">\((A,I)\)</span>. The row operations that transformed <span class="math inline">\(A\)</span> to <span class="math inline">\(I\)</span> also transformed <span class="math inline">\(I\)</span> to <span class="math inline">\(A^{-1}\)</span>. Here’s why:</p>
<p>As noted, the row operations are such that</p>
<p><span class="math display">\[
E_4 E_3 E_2 E_1 A
\]</span></p>
<p>give us the final transformed result, i.e.&nbsp;<span class="math inline">\(I\)</span>:</p>
<p><span class="math display">\[
E_4 E_3 E_2 E_1 A = I
\]</span></p>
<div class="page-columns page-full"><p>Then</p><div class="no-row-height column-margin column-container"><span class="">Recall that the inverse of a product (if it exists is the reverse product of the inverses.</span></div></div>
<p><span class="math display">\[
A = (E_4 E_3 E_2 E_1)^{-1} I = E_4^{-1} E_3^{-1} E_2^{-1} E_1^{-1}
\]</span></p>
<p>So this accomplishes our goal of computing <span class="math inline">\(A^{-1}\)</span>, provided we have the inverses of the elementary matrices <span class="math inline">\(E_i\)</span>, But those are easy, as each simply “undoes” its partner. <span class="math inline">\(E_1\)</span>, for instance, multiplies the row 1, column 1 element by 1/4, which is “undone” by multiplying that element by 4,</p>
<p><span class="math display">\[
E_1^{-1} =
\left (
\begin{array}{rr}
4 &amp; 0 \\
0 &amp; 1  \\
\end{array}
\right )
\]</span></p>
<p>Also, to undo the operation of adding 8 times row 1 to row 2, we add -8 times row 1 to row 2:</p>
<p><span class="math display">\[
E_2^{-1} =
\left (
\begin{array}{rr}
1 &amp; 0 \\
-8 &amp; 1 \\
\end{array}
\right )
\]</span></p>
<p>❄️ <strong>Your Turn:</strong> Find the inverses of <span class="math inline">\(E_3\)</span> and <span class="math inline">\(E_4\)</span> using similar reasoning, and thus find <span class="math inline">\(A^{-1}\)</span>.</p>
</section>
</section>
<section id="nonexistent-inverse" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="nonexistent-inverse"><span class="header-section-number">2.4</span> Nonexistent inverse</h2>
<p>Suppose our matrix <span class="math inline">\(A\)</span> had been slightly different:</p>
<p><span class="math display">\[
A =
\left (
\begin{array}{rr}
4 &amp; 7 \\
-8 &amp; -14  \\
\end{array}
\right )
\]</span></p>
<p>This would have led to</p>
<p><span class="math display">\[
\left (
\begin{array}{rr}
1 &amp; \frac{7}{4} \\
0 &amp; 0  \\
\end{array}
\right )
\]</span></p>
<p>This cannot lead to <span class="math inline">\(i\)</span>, indicating that <span class="math inline">\(A^{-1}\)</span> does not exist. And it’s no coincidence that row 2 of <span class="math inline">\(A\)</span> is double row 1. This has many implications, as will be seen in our chapter on vector spaces.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Ch1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Matrix Multiplication</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch3.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Linear Statistical Models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>